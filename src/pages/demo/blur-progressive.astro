---
import Layout from '../../layouts/Layout.astro';
---

<Layout title="Progressive Blur Demo" noindex={true}>
  <h1>Progressive Blur</h1>
  <p class="subtitle">7-layer stacked blur with true intensity fade (Apple-style)</p>

  <div class="demo-controls">
    <div class="layer-toggles">
      <span class="control-label">Layers:</span>
      <div class="layer-buttons">
        <label class="layer-toggle">
          <input type="checkbox" data-layer="1" checked />
          <span>1px</span>
        </label>
        <label class="layer-toggle">
          <input type="checkbox" data-layer="2" checked />
          <span>2px</span>
        </label>
        <label class="layer-toggle">
          <input type="checkbox" data-layer="3" checked />
          <span>4px</span>
        </label>
        <label class="layer-toggle">
          <input type="checkbox" data-layer="4" checked />
          <span>8px</span>
        </label>
        <label class="layer-toggle">
          <input type="checkbox" data-layer="5" checked />
          <span>16px</span>
        </label>
        <label class="layer-toggle">
          <input type="checkbox" data-layer="6" checked />
          <span>32px</span>
        </label>
        <label class="layer-toggle">
          <input type="checkbox" data-layer="7" checked />
          <span>64px</span>
        </label>
      </div>
    </div>
    <button class="toggle-all-btn" id="toggle-all">Toggle All</button>
    <label class="debug-toggle">
      <input type="checkbox" id="debug-colors" />
      <span>Debug Colors</span>
    </label>
    <label class="debug-toggle">
      <input type="checkbox" id="enable-blur" checked />
      <span>Blur</span>
    </label>
    <label class="debug-toggle">
      <input type="checkbox" id="enable-scrim" />
      <span>Scrim</span>
    </label>
    <div class="height-toggle">
      <span class="toggle-label">Height:</span>
      <div class="toggle-buttons">
        <button class="toggle-btn" data-height="card">Card</button>
        <button class="toggle-btn active" data-height="textbox">Textbox</button>
      </div>
    </div>
    <div class="height-toggle">
      <span class="toggle-label">Direction:</span>
      <div class="toggle-buttons">
        <button class="toggle-btn active" data-direction="bottom">Bottom</button>
        <button class="toggle-btn" data-direction="top">Top</button>
        <button class="toggle-btn" data-direction="left">Left</button>
        <button class="toggle-btn" data-direction="right">Right</button>
      </div>
    </div>
    <div class="height-toggle">
      <span class="toggle-label">Text:</span>
      <div class="toggle-buttons">
        <button class="toggle-btn" data-text="title">Title</button>
        <button class="toggle-btn" data-text="subtitle">+ Sub</button>
        <button class="toggle-btn active" data-text="full">+ Desc</button>
      </div>
    </div>
    <div class="slider-group">
      <label class="slider-control">
        <span class="slider-label">Start: <span id="blur-start-value">0%</span></span>
        <input type="range" id="blur-start" min="0" max="100" step="5" value="0" />
      </label>
      <label class="slider-control">
        <span class="slider-label">End: <span id="blur-end-value">100%</span></span>
        <input type="range" id="blur-end" min="0" max="100" step="5" value="100" />
      </label>
    </div>
  </div>

  <div class="demo-container">
    <div class="poster-card">
      <img src="/posters/taxi-driver.png" alt="Taxi Driver poster" class="poster-image" />
      <div class="scrim-layer"></div>
      <div class="progressive-blur">
        <div class="blur-layer layer-1" data-layer="1"></div>
        <div class="blur-layer layer-2" data-layer="2"></div>
        <div class="blur-layer layer-3" data-layer="3"></div>
        <div class="blur-layer layer-4" data-layer="4"></div>
        <div class="blur-layer layer-5" data-layer="5"></div>
        <div class="blur-layer layer-6" data-layer="6"></div>
        <div class="blur-layer layer-7" data-layer="7"></div>
      </div>
      <div class="text-overlay">
        <h3>Taxi Driver</h3>
        <p>Martin Scorsese • 1976</p>
        <p class="description">A mentally unstable veteran works as a nighttime taxi driver in New York City, where the perceived decadence and sleaze fuels his urge for violent action.</p>
      </div>
    </div>

  </div>

  <div class="aspect-ratio-section">
    <h2>Aspect Ratios</h2>
    <p class="section-desc">Progressive blur across different card shapes</p>
    <div class="aspect-ratio-grid">
      <div class="poster-card aspect-2-1">
        <img src="/posters/lonesome.png" alt="Lonesome poster" class="poster-image" />
        <div class="scrim-layer"></div>
        <div class="progressive-blur">
          <div class="blur-layer layer-1"></div>
          <div class="blur-layer layer-2"></div>
          <div class="blur-layer layer-3"></div>
          <div class="blur-layer layer-4"></div>
          <div class="blur-layer layer-5"></div>
          <div class="blur-layer layer-6"></div>
          <div class="blur-layer layer-7"></div>
        </div>
        <div class="text-overlay">
          <h3>Lonesome</h3>
          <p>Paul Fejos • 1928</p>
          <p class="description">Two lonely New Yorkers meet at Coney Island and fall in love.</p>
        </div>
      </div>
      <div class="poster-card aspect-16-9">
        <img src="/posters/street-scene.png" alt="Street Scene poster" class="poster-image" />
        <div class="scrim-layer"></div>
        <div class="progressive-blur">
          <div class="blur-layer layer-1"></div>
          <div class="blur-layer layer-2"></div>
          <div class="blur-layer layer-3"></div>
          <div class="blur-layer layer-4"></div>
          <div class="blur-layer layer-5"></div>
          <div class="blur-layer layer-6"></div>
          <div class="blur-layer layer-7"></div>
        </div>
        <div class="text-overlay">
          <h3>Street Scene</h3>
          <p>King Vidor • 1931</p>
          <p class="description">Life at a working-class New York apartment building.</p>
        </div>
      </div>
      <div class="poster-card aspect-4-3">
        <img src="/posters/the-window.png" alt="The Window poster" class="poster-image" />
        <div class="scrim-layer"></div>
        <div class="progressive-blur">
          <div class="blur-layer layer-1"></div>
          <div class="blur-layer layer-2"></div>
          <div class="blur-layer layer-3"></div>
          <div class="blur-layer layer-4"></div>
          <div class="blur-layer layer-5"></div>
          <div class="blur-layer layer-6"></div>
          <div class="blur-layer layer-7"></div>
        </div>
        <div class="text-overlay">
          <h3>The Window</h3>
          <p>Ted Tetzlaff • 1949</p>
          <p class="description">A boy who cries wolf witnesses a real murder.</p>
        </div>
      </div>
      <div class="poster-card aspect-1-1">
        <img src="/posters/hester-street.png" alt="Hester Street poster" class="poster-image" />
        <div class="scrim-layer"></div>
        <div class="progressive-blur">
          <div class="blur-layer layer-1"></div>
          <div class="blur-layer layer-2"></div>
          <div class="blur-layer layer-3"></div>
          <div class="blur-layer layer-4"></div>
          <div class="blur-layer layer-5"></div>
          <div class="blur-layer layer-6"></div>
          <div class="blur-layer layer-7"></div>
        </div>
        <div class="text-overlay">
          <h3>Hester Street</h3>
          <p>Joan Micklin Silver • 1975</p>
          <p class="description">Jewish immigrants adapt to life in 1890s New York.</p>
        </div>
      </div>
      <div class="poster-card aspect-3-4">
        <img src="/posters/taxi.png" alt="Taxi! poster" class="poster-image" />
        <div class="scrim-layer"></div>
        <div class="progressive-blur">
          <div class="blur-layer layer-1"></div>
          <div class="blur-layer layer-2"></div>
          <div class="blur-layer layer-3"></div>
          <div class="blur-layer layer-4"></div>
          <div class="blur-layer layer-5"></div>
          <div class="blur-layer layer-6"></div>
          <div class="blur-layer layer-7"></div>
        </div>
        <div class="text-overlay">
          <h3>Taxi!</h3>
          <p>Roy Del Ruth • 1932</p>
          <p class="description">A cab driver battles a rival taxi company.</p>
        </div>
      </div>
      <div class="poster-card aspect-2-3">
        <img src="/posters/three-on-a-match.png" alt="Three on a Match poster" class="poster-image" />
        <div class="scrim-layer"></div>
        <div class="progressive-blur">
          <div class="blur-layer layer-1"></div>
          <div class="blur-layer layer-2"></div>
          <div class="blur-layer layer-3"></div>
          <div class="blur-layer layer-4"></div>
          <div class="blur-layer layer-5"></div>
          <div class="blur-layer layer-6"></div>
          <div class="blur-layer layer-7"></div>
        </div>
        <div class="text-overlay">
          <h3>Three on a Match</h3>
          <p>Mervyn LeRoy • 1932</p>
          <p class="description">Three childhood friends reunite with tragic consequences.</p>
        </div>
      </div>
      <div class="poster-card aspect-9-16">
        <img src="/posters/mean-streets.png" alt="Mean Streets poster" class="poster-image" />
        <div class="scrim-layer"></div>
        <div class="progressive-blur">
          <div class="blur-layer layer-1"></div>
          <div class="blur-layer layer-2"></div>
          <div class="blur-layer layer-3"></div>
          <div class="blur-layer layer-4"></div>
          <div class="blur-layer layer-5"></div>
          <div class="blur-layer layer-6"></div>
          <div class="blur-layer layer-7"></div>
        </div>
        <div class="text-overlay">
          <h3>Mean Streets</h3>
          <p>Scorsese • 1973</p>
          <p class="description">Small-time hood tries to reconcile his faith with mob ties.</p>
        </div>
      </div>
      <div class="poster-card aspect-1-2">
        <img src="/posters/taxi-driver.png" alt="Taxi Driver poster" class="poster-image" />
        <div class="scrim-layer"></div>
        <div class="progressive-blur">
          <div class="blur-layer layer-1"></div>
          <div class="blur-layer layer-2"></div>
          <div class="blur-layer layer-3"></div>
          <div class="blur-layer layer-4"></div>
          <div class="blur-layer layer-5"></div>
          <div class="blur-layer layer-6"></div>
          <div class="blur-layer layer-7"></div>
        </div>
        <div class="text-overlay">
          <h3>Taxi Driver</h3>
          <p>Scorsese • 1976</p>
          <p class="description">A troubled vet drives NYC's mean streets at night.</p>
        </div>
      </div>
    </div>
  </div>

  <div class="comparison-section">
    <h2>Side-by-Side Comparison</h2>
    <p class="section-desc">Drag slider to compare simple (left) vs progressive 7-layer (right) blur</p>

    <div class="comparison-container">
      <div class="sbs-card" data-aspect="2-1">
        <img src="/posters/lonesome.png" alt="Lonesome" class="poster-image" />
        <div class="comparison-side comparison-left">
          <img src="/posters/lonesome.png" alt="Lonesome" class="comparison-image" />
          <div class="scrim-layer"></div>
          <div class="simple-blur-layer"></div>
          <div class="text-overlay">
            <h3>Lonesome</h3>
            <p>Paul Fejos • 1928</p>
            <p class="description">Two lonely New Yorkers meet at Coney Island.</p>
          </div>
          <span class="side-label">Simple</span>
        </div>
        <div class="comparison-side comparison-right">
          <img src="/posters/lonesome.png" alt="Lonesome" class="comparison-image" />
          <div class="scrim-layer"></div>
          <div class="progressive-blur">
            <div class="blur-layer layer-1"></div>
            <div class="blur-layer layer-2"></div>
            <div class="blur-layer layer-3"></div>
            <div class="blur-layer layer-4"></div>
            <div class="blur-layer layer-5"></div>
            <div class="blur-layer layer-6"></div>
            <div class="blur-layer layer-7"></div>
          </div>
          <div class="text-overlay">
            <h3>Lonesome</h3>
            <p>Paul Fejos • 1928</p>
            <p class="description">Two lonely New Yorkers meet at Coney Island.</p>
          </div>
          <span class="side-label">Progressive</span>
        </div>
        <div class="comparison-slider"><div class="slider-handle"></div></div>
      </div>

      <div class="sbs-card" data-aspect="16-9">
        <img src="/posters/street-scene.png" alt="Street Scene" class="poster-image" />
        <div class="comparison-side comparison-left">
          <img src="/posters/street-scene.png" alt="Street Scene" class="comparison-image" />
          <div class="scrim-layer"></div>
          <div class="simple-blur-layer"></div>
          <div class="text-overlay">
            <h3>Street Scene</h3>
            <p>King Vidor • 1931</p>
            <p class="description">Life at a working-class NYC apartment.</p>
          </div>
          <span class="side-label">Simple</span>
        </div>
        <div class="comparison-side comparison-right">
          <img src="/posters/street-scene.png" alt="Street Scene" class="comparison-image" />
          <div class="scrim-layer"></div>
          <div class="progressive-blur">
            <div class="blur-layer layer-1"></div>
            <div class="blur-layer layer-2"></div>
            <div class="blur-layer layer-3"></div>
            <div class="blur-layer layer-4"></div>
            <div class="blur-layer layer-5"></div>
            <div class="blur-layer layer-6"></div>
            <div class="blur-layer layer-7"></div>
          </div>
          <div class="text-overlay">
            <h3>Street Scene</h3>
            <p>King Vidor • 1931</p>
            <p class="description">Life at a working-class NYC apartment.</p>
          </div>
          <span class="side-label">Progressive</span>
        </div>
        <div class="comparison-slider"><div class="slider-handle"></div></div>
      </div>

      <div class="sbs-card" data-aspect="3-4">
        <img src="/posters/taxi.png" alt="Taxi!" class="poster-image" />
        <div class="comparison-side comparison-left">
          <img src="/posters/taxi.png" alt="Taxi!" class="comparison-image" />
          <div class="scrim-layer"></div>
          <div class="simple-blur-layer"></div>
          <div class="text-overlay">
            <h3>Taxi!</h3>
            <p>Roy Del Ruth • 1932</p>
            <p class="description">A cab driver battles a rival company.</p>
          </div>
          <span class="side-label">Simple</span>
        </div>
        <div class="comparison-side comparison-right">
          <img src="/posters/taxi.png" alt="Taxi!" class="comparison-image" />
          <div class="scrim-layer"></div>
          <div class="progressive-blur">
            <div class="blur-layer layer-1"></div>
            <div class="blur-layer layer-2"></div>
            <div class="blur-layer layer-3"></div>
            <div class="blur-layer layer-4"></div>
            <div class="blur-layer layer-5"></div>
            <div class="blur-layer layer-6"></div>
            <div class="blur-layer layer-7"></div>
          </div>
          <div class="text-overlay">
            <h3>Taxi!</h3>
            <p>Roy Del Ruth • 1932</p>
            <p class="description">A cab driver battles a rival company.</p>
          </div>
          <span class="side-label">Progressive</span>
        </div>
        <div class="comparison-slider"><div class="slider-handle"></div></div>
      </div>

      <div class="sbs-card" data-aspect="2-3">
        <img src="/posters/taxi-driver.png" alt="Taxi Driver" class="poster-image" />
        <div class="comparison-side comparison-left">
          <img src="/posters/taxi-driver.png" alt="Taxi Driver" class="comparison-image" />
          <div class="scrim-layer"></div>
          <div class="simple-blur-layer"></div>
          <div class="text-overlay">
            <h3>Taxi Driver</h3>
            <p>Scorsese • 1976</p>
            <p class="description">A troubled vet drives NYC's mean streets.</p>
          </div>
          <span class="side-label">Simple</span>
        </div>
        <div class="comparison-side comparison-right">
          <img src="/posters/taxi-driver.png" alt="Taxi Driver" class="comparison-image" />
          <div class="scrim-layer"></div>
          <div class="progressive-blur">
            <div class="blur-layer layer-1"></div>
            <div class="blur-layer layer-2"></div>
            <div class="blur-layer layer-3"></div>
            <div class="blur-layer layer-4"></div>
            <div class="blur-layer layer-5"></div>
            <div class="blur-layer layer-6"></div>
            <div class="blur-layer layer-7"></div>
          </div>
          <div class="text-overlay">
            <h3>Taxi Driver</h3>
            <p>Scorsese • 1976</p>
            <p class="description">A troubled vet drives NYC's mean streets.</p>
          </div>
          <span class="side-label">Progressive</span>
        </div>
        <div class="comparison-slider"><div class="slider-handle"></div></div>
      </div>
    </div>
  </div>

  <div class="info-section">
    <h2>How it works</h2>
    <p>Seven blur layers are stacked, each with increasing blur values (1px → 2px → 4px → 8px → 16px → 32px → 64px). Each layer is masked to cover a different vertical region with ~7% overlap, creating a smooth progression from sharp to heavily blurred.</p>
    <pre><code>/* Layer 1 (lightest) at top, Layer 7 (heaviest) at bottom */
.layer-1 {'{'} backdrop-filter: blur(1px);  mask: linear-gradient(to top, transparent 79%, black 86%, black 93%, transparent 100%); {'}'}
.layer-2 {'{'} backdrop-filter: blur(2px);  mask: linear-gradient(to top, transparent 65%, black 72%, black 79%, transparent 86%); {'}'}
.layer-3 {'{'} backdrop-filter: blur(4px);  mask: linear-gradient(to top, transparent 51%, black 58%, black 65%, transparent 72%); {'}'}
.layer-4 {'{'} backdrop-filter: blur(8px);  mask: linear-gradient(to top, transparent 36%, black 43%, black 51%, transparent 58%); {'}'}
.layer-5 {'{'} backdrop-filter: blur(16px); mask: linear-gradient(to top, transparent 22%, black 29%, black 36%, transparent 43%); {'}'}
.layer-6 {'{'} backdrop-filter: blur(32px); mask: linear-gradient(to top, transparent 8%, black 15%, black 22%, transparent 29%); {'}'}
.layer-7 {'{'} backdrop-filter: blur(64px); mask: linear-gradient(to top, black 0%, black 8%, transparent 15%); {'}'}</code></pre>
    <p class="note"><strong>Trade-off:</strong> More DOM elements and potential performance impact, but creates a much smoother, more natural blur gradient than single-layer approaches.</p>
  </div>
</Layout>

<script>
  const params = new URLSearchParams(window.location.search);
  const layerToggles = document.querySelectorAll('.layer-toggle input');
  const toggleAllBtn = document.getElementById('toggle-all');

  // Layer toggle functionality
  layerToggles.forEach(toggle => {
    toggle.addEventListener('change', (e) => {
      const input = e.target as HTMLInputElement;
      const layerNum = input.dataset.layer;
      const isChecked = input.checked;

      // Update blur layer visibility on ALL cards
      const allLayers = document.querySelectorAll(`.blur-layer.layer-${layerNum}`);
      allLayers.forEach(layer => {
        (layer as HTMLElement).style.opacity = isChecked ? '1' : '0';
      });

      updateURL();
    });
  });

  let allOn = true;
  toggleAllBtn?.addEventListener('click', () => {
    allOn = !allOn;
    layerToggles.forEach(toggle => {
      (toggle as HTMLInputElement).checked = allOn;
      toggle.dispatchEvent(new Event('change'));
    });
  });

  // URL management
  function updateURL() {
    const newParams = new URLSearchParams(window.location.search);

    for (let i = 1; i <= 7; i++) {
      const toggle = document.querySelector(`input[data-layer="${i}"]`) as HTMLInputElement;
      if (toggle && !toggle.checked) {
        newParams.set(`layer${i}`, '0');
      } else {
        newParams.delete(`layer${i}`);
      }
    }

    // Height mode toggle (default is textbox, so only store card)
    if (heightMode === 'card') {
      newParams.set('height', 'card');
    } else {
      newParams.delete('height');
    }

    // Slider values
    if (blurStartSlider?.value !== '0') {
      newParams.set('start', blurStartSlider.value);
    } else {
      newParams.delete('start');
    }
    if (blurEndSlider?.value !== '100') {
      newParams.set('end', blurEndSlider.value);
    } else {
      newParams.delete('end');
    }

    // Debug colors toggle
    if (debugColorsToggle?.checked) {
      newParams.set('debug', '1');
    } else {
      newParams.delete('debug');
    }

    // Scrim toggle
    if (enableScrimToggle?.checked) {
      newParams.set('scrim', '1');
    } else {
      newParams.delete('scrim');
    }

    // Direction
    if (direction !== 'bottom') {
      newParams.set('dir', direction);
    } else {
      newParams.delete('dir');
    }

    // Text level
    if (textLevel !== 'full') {
      newParams.set('text', textLevel);
    } else {
      newParams.delete('text');
    }

    const newURL = newParams.toString()
      ? `${window.location.pathname}?${newParams}`
      : window.location.pathname;
    history.replaceState({}, '', newURL);
  }

  // Debug color toggle
  const debugColorsToggle = document.getElementById('debug-colors') as HTMLInputElement;
  const enableBlurToggle = document.getElementById('enable-blur') as HTMLInputElement;
  const enableScrimToggle = document.getElementById('enable-scrim') as HTMLInputElement;
  const heightToggleBtns = document.querySelectorAll('[data-height]') as NodeListOf<HTMLButtonElement>;
  const directionToggleBtns = document.querySelectorAll('[data-direction]') as NodeListOf<HTMLButtonElement>;
  const textToggleBtns = document.querySelectorAll('[data-text]') as NodeListOf<HTMLButtonElement>;
  const blurStartSlider = document.getElementById('blur-start') as HTMLInputElement;
  const blurEndSlider = document.getElementById('blur-end') as HTMLInputElement;
  const blurStartValue = document.getElementById('blur-start-value') as HTMLSpanElement;
  const blurEndValue = document.getElementById('blur-end-value') as HTMLSpanElement;

  let heightMode: 'card' | 'textbox' = 'textbox';
  let direction: 'bottom' | 'top' | 'left' | 'right' = 'bottom';
  let textLevel: 'title' | 'subtitle' | 'full' = 'full';

  // Direction config for gradient directions and text positioning
  const directionConfig: Record<string, { gradientDir: string; textPos: Record<string, string>; isHorizontal: boolean }> = {
    bottom: { gradientDir: 'to top', textPos: { bottom: '0', top: 'auto', left: '0', right: '0' }, isHorizontal: false },
    top: { gradientDir: 'to bottom', textPos: { top: '0', bottom: 'auto', left: '0', right: '0' }, isHorizontal: false },
    left: { gradientDir: 'to right', textPos: { left: '0', right: 'auto', top: '0', bottom: '0' }, isHorizontal: true },
    right: { gradientDir: 'to left', textPos: { right: '0', left: 'auto', top: '0', bottom: '0' }, isHorizontal: true }
  };

  debugColorsToggle?.addEventListener('change', () => {
    document.body.classList.toggle('debug-colors', debugColorsToggle.checked);
    updateURL();
  });

  enableBlurToggle?.addEventListener('change', () => {
    document.body.classList.toggle('blur-disabled', !enableBlurToggle.checked);
  });

  enableScrimToggle?.addEventListener('change', () => {
    document.body.classList.toggle('scrim-enabled', enableScrimToggle.checked);
    updateURL();
  });

  // Update scrim gradients to match blur zone
  function updateScrim(startPct: number, endPct: number, gradientDir: string) {
    const scrims = document.querySelectorAll('.poster-card > .scrim-layer') as NodeListOf<HTMLElement>;
    const midPct = startPct + (endPct - startPct) * 0.4;
    const gradient = `linear-gradient(${gradientDir}, rgba(15, 15, 15, 0.4) ${startPct}%, rgba(15, 15, 15, 0.2) ${midPct}%, transparent ${endPct}%)`;
    scrims.forEach(scrim => { scrim.style.background = gradient; });
  }

  function updateScrimTextRelative() {
    const config = directionConfig[direction];
    const cards = document.querySelectorAll('.demo-container .poster-card, .aspect-ratio-section .poster-card') as NodeListOf<HTMLElement>;
    cards.forEach(card => {
      const textOverlay = card.querySelector('.text-overlay') as HTMLElement;
      const scrim = card.querySelector('.scrim-layer') as HTMLElement;
      if (!textOverlay || !scrim) return;
      const cardSize = config.isHorizontal ? card.offsetWidth : card.offsetHeight;
      const textSize = config.isHorizontal ? textOverlay.offsetWidth : textOverlay.offsetHeight;
      const textSizePct = (textSize / cardSize) * 100;
      const startPct = parseFloat(blurStartSlider.value) / 100 * textSizePct;
      const endMult = parseFloat(blurEndSlider.value) / 100;
      const endPct = Math.min(textSizePct * endMult, 100);
      const midPct = startPct + (endPct - startPct) * 0.4;
      const gradient = `linear-gradient(${config.gradientDir}, rgba(15, 15, 15, 0.4) ${startPct}%, rgba(15, 15, 15, 0.2) ${midPct}%, transparent ${endPct}%)`;
      scrim.style.background = gradient;
    });
  }

  // Text-relative blur calculation
  function updateTextRelativeBlur() {
    const cards = document.querySelectorAll('.poster-card:has(.progressive-blur)') as NodeListOf<HTMLElement>;
    const config = directionConfig[direction];

    // Smooth overlapping masks with ~20% overlap for smoother blending
    const layerMasks = [
      { fadeIn: 65, solidStart: 80, solidEnd: 100 },  // layer-1 (top, lightest)
      { fadeIn: 50, solidStart: 65, solidEnd: 85, fadeOut: 100 },
      { fadeIn: 35, solidStart: 50, solidEnd: 70, fadeOut: 90 },
      { fadeIn: 20, solidStart: 35, solidEnd: 55, fadeOut: 75 },
      { fadeIn: 5, solidStart: 20, solidEnd: 40, fadeOut: 60 },
      { fadeIn: 0, solidStart: 5, solidEnd: 25, fadeOut: 45 },
      { fadeIn: 0, solidStart: 0, solidEnd: 10, fadeOut: 30 }   // layer-7 (bottom, heaviest)
    ];

    cards.forEach(card => {
      const textOverlay = card.querySelector('.text-overlay') as HTMLElement;
      const layers = card.querySelectorAll('.blur-layer') as NodeListOf<HTMLElement>;
      if (!textOverlay) return;

      // Use width for horizontal directions, height for vertical
      const cardSize = config.isHorizontal ? card.offsetWidth : card.offsetHeight;
      const textSize = config.isHorizontal ? textOverlay.offsetWidth : textOverlay.offsetHeight;
      const textSizePct = (textSize / cardSize) * 100;

      // Sliders act as multipliers when text-relative is on
      const startPct = parseFloat(blurStartSlider.value) / 100 * textSizePct;
      const endMult = parseFloat(blurEndSlider.value) / 100;
      const blurEndPct = Math.min(textSizePct * endMult, 100);

      const range = blurEndPct - startPct;
      const scale = range / 100;

      // Apply text position
      Object.assign(textOverlay.style, config.textPos);
      if (config.isHorizontal) {
        textOverlay.style.width = '50%';
        textOverlay.style.height = '100%';
        textOverlay.style.display = 'flex';
        textOverlay.style.flexDirection = 'column';
        textOverlay.style.justifyContent = 'flex-end';
      } else {
        textOverlay.style.width = '';
        textOverlay.style.height = '';
        textOverlay.style.display = '';
        textOverlay.style.flexDirection = '';
        textOverlay.style.justifyContent = '';
      }

      layers.forEach((layer, i) => {
        const mask = layerMasks[i];
        const fadeIn = startPct + mask.fadeIn * scale;
        const solidStart = startPct + mask.solidStart * scale;
        const solidEnd = Math.min(startPct + mask.solidEnd * scale, blurEndPct);
        const fadeOut = mask.fadeOut ? Math.min(startPct + mask.fadeOut * scale, blurEndPct) : blurEndPct;

        let gradient: string;
        if (i === 0) {
          gradient = `linear-gradient(${config.gradientDir}, transparent ${fadeIn}%, black ${solidStart}%, black ${blurEndPct}%, transparent ${blurEndPct}%)`;
        } else if (i === 6) {
          gradient = `linear-gradient(${config.gradientDir}, black ${startPct}%, black ${solidEnd}%, transparent ${fadeOut}%)`;
        } else {
          gradient = `linear-gradient(${config.gradientDir}, transparent ${fadeIn}%, black ${solidStart}%, black ${solidEnd}%, transparent ${fadeOut}%)`;
        }

        layer.style.maskImage = gradient;
        layer.style.webkitMaskImage = gradient;
      });
    });
    updateScrimTextRelative();
  }

  function resetToStaticMasks() {
    const config = directionConfig[direction];
    const cards = document.querySelectorAll('.poster-card:has(.progressive-blur)') as NodeListOf<HTMLElement>;

    // Static masks for full card height
    const staticMasks = [
      'transparent 65%, black 80%, black 100%',
      'transparent 50%, black 65%, black 85%, transparent 100%',
      'transparent 35%, black 50%, black 70%, transparent 90%',
      'transparent 20%, black 35%, black 55%, transparent 75%',
      'transparent 5%, black 20%, black 40%, transparent 60%',
      'transparent 0%, black 5%, black 25%, transparent 45%',
      'black 0%, black 10%, transparent 30%'
    ];

    cards.forEach(card => {
      const layers = card.querySelectorAll('.blur-layer') as NodeListOf<HTMLElement>;
      const textOverlay = card.querySelector('.text-overlay') as HTMLElement;

      // Apply text position
      if (textOverlay) {
        Object.assign(textOverlay.style, config.textPos);
        if (config.isHorizontal) {
          textOverlay.style.width = '50%';
          textOverlay.style.height = '100%';
          textOverlay.style.display = 'flex';
          textOverlay.style.flexDirection = 'column';
          textOverlay.style.justifyContent = 'flex-end';
        } else {
          textOverlay.style.width = '';
          textOverlay.style.height = '';
          textOverlay.style.display = '';
          textOverlay.style.flexDirection = '';
          textOverlay.style.justifyContent = '';
        }
      }

      layers.forEach((layer, i) => {
        const gradient = `linear-gradient(${config.gradientDir}, ${staticMasks[i]})`;
        layer.style.maskImage = gradient;
        layer.style.webkitMaskImage = gradient;
      });
    });
  }

  heightToggleBtns.forEach(btn => {
    btn.addEventListener('click', () => {
      heightToggleBtns.forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      heightMode = btn.dataset.height as 'card' | 'textbox';

      updateSliderLabels();
      if (heightMode === 'textbox') {
        updateTextRelativeBlur();
      } else {
        // When switching to card mode, use sliders as absolute percentages
        if (blurStartSlider.value === '0' && blurEndSlider.value === '100') {
          resetToStaticMasks();
        } else {
          updateBlurFromSliders();
        }
      }
      updateComparisonBlur();
      updateURL();
    });
  });

  // Direction toggle
  directionToggleBtns.forEach(btn => {
    btn.addEventListener('click', () => {
      directionToggleBtns.forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      direction = btn.dataset.direction as 'bottom' | 'top' | 'left' | 'right';
      applyDirection();
      updateComparisonBlur();
      updateURL();
    });
  });

  // Text level toggle
  textToggleBtns.forEach(btn => {
    btn.addEventListener('click', () => {
      textToggleBtns.forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      textLevel = btn.dataset.text as 'title' | 'subtitle' | 'full';
      applyTextLevel();
      // Recalculate blur since text height changed
      if (heightMode === 'textbox') {
        requestAnimationFrame(() => updateTextRelativeBlur());
      }
      updateURL();
    });
  });

  function applyDirection() {
    const config = directionConfig[direction];
    const cards = document.querySelectorAll('.poster-card:has(.progressive-blur)') as NodeListOf<HTMLElement>;

    cards.forEach(card => {
      const layers = card.querySelectorAll('.blur-layer') as NodeListOf<HTMLElement>;
      const textOverlay = card.querySelector('.text-overlay') as HTMLElement;

      // Update gradient direction for all layers
      layers.forEach(layer => {
        const currentMask = getComputedStyle(layer).maskImage || layer.style.maskImage;
        if (currentMask && currentMask !== 'none') {
          // Replace gradient direction in existing mask
          const newMask = currentMask.replace(/linear-gradient\([^,]+,/, `linear-gradient(${config.gradientDir},`);
          layer.style.maskImage = newMask;
          layer.style.webkitMaskImage = newMask;
        }
      });

      // Update text position
      if (textOverlay) {
        Object.assign(textOverlay.style, config.textPos);
        if (config.isHorizontal) {
          textOverlay.style.width = '50%';
          textOverlay.style.height = '100%';
          textOverlay.style.display = 'flex';
          textOverlay.style.flexDirection = 'column';
          textOverlay.style.justifyContent = 'flex-end';
        } else {
          textOverlay.style.width = '';
          textOverlay.style.height = '';
          textOverlay.style.display = '';
          textOverlay.style.flexDirection = '';
          textOverlay.style.justifyContent = '';
        }
      }
    });

    // Reapply blur calculations with new direction
    if (heightMode === 'textbox') {
      updateTextRelativeBlur();
    } else if (blurStartSlider.value !== '0' || blurEndSlider.value !== '100') {
      updateBlurFromSliders();
    } else {
      resetToStaticMasks();
    }
  }

  function applyTextLevel() {
    document.body.classList.remove('text-title-only', 'text-with-subtitle');
    if (textLevel === 'title') {
      document.body.classList.add('text-title-only');
    } else if (textLevel === 'subtitle') {
      document.body.classList.add('text-with-subtitle');
    }
  }

  // Slider-controlled blur zone
  function updateBlurFromSliders() {
    const startPct = parseFloat(blurStartSlider.value);
    const endPct = parseFloat(blurEndSlider.value);
    const config = directionConfig[direction];

    // Ensure start < end
    if (startPct >= endPct) return;

    const range = endPct - startPct;
    const scale = range / 100;

    // Smooth overlapping masks with ~20% overlap for smoother blending
    const layerMasks = [
      { fadeIn: 65, solidStart: 80, solidEnd: 100 },
      { fadeIn: 50, solidStart: 65, solidEnd: 85, fadeOut: 100 },
      { fadeIn: 35, solidStart: 50, solidEnd: 70, fadeOut: 90 },
      { fadeIn: 20, solidStart: 35, solidEnd: 55, fadeOut: 75 },
      { fadeIn: 5, solidStart: 20, solidEnd: 40, fadeOut: 60 },
      { fadeIn: 0, solidStart: 5, solidEnd: 25, fadeOut: 45 },
      { fadeIn: 0, solidStart: 0, solidEnd: 10, fadeOut: 30 }
    ];

    const cards = document.querySelectorAll('.poster-card:has(.progressive-blur)') as NodeListOf<HTMLElement>;
    cards.forEach(card => {
      const layers = card.querySelectorAll('.blur-layer') as NodeListOf<HTMLElement>;
      const textOverlay = card.querySelector('.text-overlay') as HTMLElement;

      // Apply text position
      if (textOverlay) {
        Object.assign(textOverlay.style, config.textPos);
        if (config.isHorizontal) {
          textOverlay.style.width = '50%';
          textOverlay.style.height = '100%';
          textOverlay.style.display = 'flex';
          textOverlay.style.flexDirection = 'column';
          textOverlay.style.justifyContent = 'flex-end';
        } else {
          textOverlay.style.width = '';
          textOverlay.style.height = '';
          textOverlay.style.display = '';
          textOverlay.style.flexDirection = '';
          textOverlay.style.justifyContent = '';
        }
      }

      layers.forEach((layer, i) => {
        const mask = layerMasks[i];
        const fadeIn = startPct + mask.fadeIn * scale;
        const solidStart = startPct + mask.solidStart * scale;
        const solidEnd = Math.min(startPct + mask.solidEnd * scale, endPct);
        const fadeOut = mask.fadeOut ? Math.min(startPct + mask.fadeOut * scale, endPct) : endPct;

        let gradient: string;
        if (i === 0) {
          gradient = `linear-gradient(${config.gradientDir}, transparent ${fadeIn}%, black ${solidStart}%, black ${endPct}%, transparent ${endPct}%)`;
        } else if (i === 6) {
          gradient = `linear-gradient(${config.gradientDir}, black ${startPct}%, black ${solidEnd}%, transparent ${fadeOut}%)`;
        } else {
          gradient = `linear-gradient(${config.gradientDir}, transparent ${fadeIn}%, black ${solidStart}%, black ${solidEnd}%, transparent ${fadeOut}%)`;
        }

        layer.style.maskImage = gradient;
        layer.style.webkitMaskImage = gradient;
      });
    });
  }

  function updateSliderLabels() {
    if (heightMode === 'textbox') {
      blurStartValue.textContent = `${blurStartSlider.value}%`;
      blurEndValue.textContent = `${(parseFloat(blurEndSlider.value) / 100).toFixed(1)}×`;
    } else {
      blurStartValue.textContent = `${blurStartSlider.value}%`;
      blurEndValue.textContent = `${blurEndSlider.value}%`;
    }
  }

  blurStartSlider?.addEventListener('input', () => {
    updateSliderLabels();
    if (heightMode === 'textbox') {
      updateTextRelativeBlur();
    } else {
      updateBlurFromSliders();
    }
    updateComparisonBlur();
    updateURL();
  });

  blurEndSlider?.addEventListener('input', () => {
    updateSliderLabels();
    if (heightMode === 'textbox') {
      updateTextRelativeBlur();
    } else {
      updateBlurFromSliders();
    }
    updateComparisonBlur();
    updateURL();
  });

  // Update on resize when textbox mode is enabled
  window.addEventListener('resize', () => {
    if (heightMode === 'textbox') {
      updateTextRelativeBlur();
    }
  });

  // Initialize on load
  window.addEventListener('load', () => {
    // Restore layer toggles from URL
    for (let i = 1; i <= 7; i++) {
      if (params.get(`layer${i}`) === '0') {
        const toggle = document.querySelector(`input[data-layer="${i}"]`) as HTMLInputElement;
        if (toggle) {
          toggle.checked = false;
          // Update ALL layers with this class
          const allLayers = document.querySelectorAll(`.blur-layer.layer-${i}`);
          allLayers.forEach(layer => {
            (layer as HTMLElement).style.opacity = '0';
          });
        }
      }
    }

    // Restore slider values from URL
    const startParam = params.get('start');
    const endParam = params.get('end');
    if (startParam) {
      blurStartSlider.value = startParam;
      blurStartValue.textContent = `${startParam}%`;
    }
    if (endParam) {
      blurEndSlider.value = endParam;
      blurEndValue.textContent = `${endParam}%`;
    }

    // Apply slider values if not at defaults
    if (startParam || endParam) {
      updateBlurFromSliders();
    }

    // Restore height mode toggle (default is textbox)
    const heightParam = params.get('height');
    if (heightParam === 'card') {
      heightMode = 'card';
      heightToggleBtns.forEach(btn => {
        btn.classList.toggle('active', btn.dataset.height === 'card');
      });
    } else {
      // Default to textbox mode
      heightMode = 'textbox';
      updateSliderLabels();
      updateTextRelativeBlur();
    }

    // Restore debug colors toggle
    if (params.get('debug') === '1') {
      debugColorsToggle.checked = true;
      document.body.classList.add('debug-colors');
    }

    // Restore direction
    const dirParam = params.get('dir');
    if (dirParam && ['bottom', 'top', 'left', 'right'].includes(dirParam)) {
      direction = dirParam as 'bottom' | 'top' | 'left' | 'right';
      directionToggleBtns.forEach(btn => {
        btn.classList.toggle('active', btn.dataset.direction === direction);
      });
      applyDirection();
    }

    // Restore text level
    const textParam = params.get('text');
    if (textParam && ['title', 'subtitle', 'full'].includes(textParam)) {
      textLevel = textParam as 'title' | 'subtitle' | 'full';
      textToggleBtns.forEach(btn => {
        btn.classList.toggle('active', btn.dataset.text === textLevel);
      });
      applyTextLevel();
    }

    // Restore scrim toggle
    if (params.get('scrim') === '1') {
      enableScrimToggle.checked = true;
      document.body.classList.add('scrim-enabled');
    }

    // Initialize SBS sliders
    initSbsSliders();
    updateComparisonBlur();
  });

  // SBS Comparison Sliders
  const sbsCards = document.querySelectorAll('.sbs-card') as NodeListOf<HTMLElement>;
  let sbsIsDragging = false;
  let sbsActiveCard: HTMLElement | null = null;

  function updateAllSbsSliders(percent: number) {
    sbsCards.forEach(card => {
      const slider = card.querySelector('.comparison-slider') as HTMLElement;
      const left = card.querySelector('.comparison-left') as HTMLElement;
      const right = card.querySelector('.comparison-right') as HTMLElement;
      if (!slider || !left || !right) return;
      slider.style.left = `${percent}%`;
      left.style.clipPath = `inset(0 ${100 - percent}% 0 0)`;
      right.style.clipPath = `inset(0 0 0 ${percent}%)`;
    });
  }

  function initSbsSliders() {
    sbsCards.forEach(card => {
      const slider = card.querySelector('.comparison-slider') as HTMLElement;
      if (!slider) return;
      slider.addEventListener('mousedown', e => { sbsIsDragging = true; sbsActiveCard = card; e.preventDefault(); });
      card.addEventListener('mousedown', e => {
        if ((e.target as HTMLElement).closest('.comparison-slider')) return;
        sbsIsDragging = true; sbsActiveCard = card;
        const rect = card.getBoundingClientRect();
        updateAllSbsSliders(Math.max(0, Math.min(100, ((e.clientX - rect.left) / rect.width) * 100)));
      });
      slider.addEventListener('touchstart', e => { sbsIsDragging = true; sbsActiveCard = card; e.preventDefault(); });
      card.addEventListener('touchstart', e => {
        if ((e.target as HTMLElement).closest('.comparison-slider')) return;
        sbsIsDragging = true; sbsActiveCard = card;
        const rect = card.getBoundingClientRect();
        updateAllSbsSliders(Math.max(0, Math.min(100, ((e.touches[0].clientX - rect.left) / rect.width) * 100)));
      });
    });
    document.addEventListener('mousemove', e => {
      if (!sbsActiveCard || !sbsIsDragging) return;
      const rect = sbsActiveCard.getBoundingClientRect();
      updateAllSbsSliders(Math.max(0, Math.min(100, ((e.clientX - rect.left) / rect.width) * 100)));
    });
    document.addEventListener('mouseup', () => { sbsIsDragging = false; sbsActiveCard = null; });
    document.addEventListener('touchmove', e => {
      if (!sbsActiveCard || !sbsIsDragging) return;
      const rect = sbsActiveCard.getBoundingClientRect();
      updateAllSbsSliders(Math.max(0, Math.min(100, ((e.touches[0].clientX - rect.left) / rect.width) * 100)));
    });
    document.addEventListener('touchend', () => { sbsIsDragging = false; sbsActiveCard = null; });
    updateAllSbsSliders(50);
  }

  function updateComparisonBlur() {
    const config = directionConfig[direction];
    const startVal = parseFloat(blurStartSlider.value);
    const endVal = parseFloat(blurEndSlider.value);
    sbsCards.forEach(card => {
      const simpleBlur = card.querySelector('.simple-blur-layer') as HTMLElement;
      const progressiveBlur = card.querySelector('.progressive-blur') as HTMLElement;
      const textRight = card.querySelector('.comparison-right .text-overlay') as HTMLElement;
      if (!simpleBlur || !progressiveBlur || !textRight) return;
      const cardSize = config.isHorizontal ? card.offsetWidth : card.offsetHeight;
      let startPct: number, endPct: number;
      if (heightMode === 'textbox') {
        const textSize = config.isHorizontal ? textRight.offsetWidth : textRight.offsetHeight;
        const textSizePct = (textSize / cardSize) * 100;
        startPct = (startVal / 100) * textSizePct;
        endPct = Math.min(textSizePct * (endVal / 100), 100);
      } else {
        startPct = startVal;
        endPct = endVal;
      }
      // Simple blur
      const simpleGrad = `linear-gradient(${config.gradientDir}, black ${startPct}%, black ${startPct + (endPct - startPct) * 0.3}%, transparent ${endPct}%)`;
      simpleBlur.style.maskImage = simpleGrad;
      simpleBlur.style.webkitMaskImage = simpleGrad;
      // Progressive blur layers
      const layers = progressiveBlur.querySelectorAll('.blur-layer') as NodeListOf<HTMLElement>;
      const masks = [
        { fadeIn: 65, solidStart: 80, solidEnd: 100 },
        { fadeIn: 50, solidStart: 65, solidEnd: 85, fadeOut: 100 },
        { fadeIn: 35, solidStart: 50, solidEnd: 70, fadeOut: 90 },
        { fadeIn: 20, solidStart: 35, solidEnd: 55, fadeOut: 75 },
        { fadeIn: 5, solidStart: 20, solidEnd: 40, fadeOut: 60 },
        { fadeIn: 0, solidStart: 5, solidEnd: 25, fadeOut: 45 },
        { fadeIn: 0, solidStart: 0, solidEnd: 10, fadeOut: 30 }
      ];
      const range = endPct - startPct;
      const scale = range / 100;
      layers.forEach((layer, i) => {
        const m = masks[i];
        const fadeIn = startPct + m.fadeIn * scale;
        const solidStart = startPct + m.solidStart * scale;
        const solidEnd = Math.min(startPct + m.solidEnd * scale, endPct);
        const fadeOut = m.fadeOut ? Math.min(startPct + m.fadeOut * scale, endPct) : endPct;
        let grad: string;
        if (i === 0) grad = `linear-gradient(${config.gradientDir}, transparent ${fadeIn}%, black ${solidStart}%, black ${endPct}%, transparent ${endPct}%)`;
        else if (i === 6) grad = `linear-gradient(${config.gradientDir}, black ${startPct}%, black ${solidEnd}%, transparent ${fadeOut}%)`;
        else grad = `linear-gradient(${config.gradientDir}, transparent ${fadeIn}%, black ${solidStart}%, black ${solidEnd}%, transparent ${fadeOut}%)`;
        layer.style.maskImage = grad;
        layer.style.webkitMaskImage = grad;
      });

      // Update SBS scrim gradients
      const scrims = card.querySelectorAll('.comparison-side .scrim-layer') as NodeListOf<HTMLElement>;
      const midPct = startPct + (endPct - startPct) * 0.4;
      const scrimGrad = `linear-gradient(${config.gradientDir}, rgba(15, 15, 15, 0.4) ${startPct}%, rgba(15, 15, 15, 0.2) ${midPct}%, transparent ${endPct}%)`;
      scrims.forEach(scrim => { scrim.style.background = scrimGrad; });
    });
  }
</script>

<style>
  h1 {
    margin-top: 20px;
  }

  /* Add padding for floating control bar */
  :global(main) {
    padding-bottom: 80px;
  }

  .demo-controls {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    display: flex;
    flex-wrap: wrap;
    gap: 16px;
    justify-content: center;
    align-items: center;
    padding: 12px 16px;
    background: var(--bg-movie);
    border-top: 1px solid var(--bg-movie-hover);
    z-index: 100;
  }

  .layer-toggles {
    display: flex;
    align-items: center;
    gap: 12px;
  }

  .control-label {
    font-size: 14px;
    color: var(--text-secondary);
  }

  .layer-buttons {
    display: flex;
    gap: 4px;
  }

  .layer-toggle {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 6px 10px;
    font-size: 12px;
    font-family: monospace;
    color: var(--text-secondary);
    background: transparent;
    border: 1px solid var(--bg-movie-hover);
    border-radius: 4px;
    cursor: pointer;
    transition: all 0.15s;
  }

  .layer-toggle:has(input:checked) {
    background: var(--accent);
    border-color: var(--accent);
    color: white;
  }

  .layer-toggle input {
    position: absolute;
    opacity: 0;
    pointer-events: none;
  }

  .toggle-all-btn {
    padding: 6px 12px;
    font-size: 13px;
    background: var(--bg-movie-hover);
    border: 1px solid var(--bg-movie-hover);
    border-radius: 4px;
    color: var(--text-secondary);
    cursor: pointer;
    transition: all 0.15s;
  }

  .toggle-all-btn:hover {
    background: var(--accent);
    border-color: var(--accent);
    color: white;
  }

  .debug-toggle {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 13px;
    color: var(--text-secondary);
    cursor: pointer;
  }

  .debug-toggle input {
    cursor: pointer;
  }

  .height-toggle {
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .toggle-label {
    font-size: 13px;
    color: var(--text-secondary);
  }

  .toggle-buttons {
    display: flex;
    background: var(--bg-movie-hover);
    border-radius: 4px;
    overflow: hidden;
  }

  .toggle-btn {
    padding: 6px 12px;
    font-size: 12px;
    background: transparent;
    border: none;
    color: var(--text-secondary);
    cursor: pointer;
    transition: all 0.15s;
  }

  .toggle-btn.active {
    background: var(--accent);
    color: white;
  }

  .toggle-btn:hover:not(.active) {
    background: rgba(255, 255, 255, 0.1);
  }

  .slider-group {
    display: flex;
    gap: 16px;
    padding: 8px 12px;
    background: var(--bg-movie-hover);
    border-radius: 6px;
  }

  .slider-control {
    display: flex;
    flex-direction: column;
    gap: 4px;
  }

  .slider-label {
    font-size: 12px;
    color: var(--text-secondary);
    font-family: monospace;
  }

  input[type="range"] {
    -webkit-appearance: none;
    width: 120px;
    height: 4px;
    background: var(--bg-movie);
    border-radius: 2px;
    cursor: pointer;
  }

  input[type="range"]::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 14px;
    height: 14px;
    background: var(--accent);
    border-radius: 50%;
    cursor: pointer;
    transition: transform 0.1s ease;
  }

  input[type="range"]::-webkit-slider-thumb:hover {
    transform: scale(1.2);
  }

  input[type="range"]::-moz-range-thumb {
    width: 14px;
    height: 14px;
    background: var(--accent);
    border-radius: 50%;
    border: none;
    cursor: pointer;
  }

  .demo-container {
    display: flex;
    justify-content: center;
    align-items: flex-start;
    gap: 32px;
    padding: 32px 16px;
    flex-wrap: wrap;
  }

  .poster-card {
    position: relative;
    width: 300px;
    height: 450px;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
  }

  .poster-card.small {
    width: 200px;
    height: 300px;
  }

  .poster-image {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .progressive-blur {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 100%;
    pointer-events: none;
  }

  .blur-layer {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 100%;
    transition: opacity 0.2s;
  }

  /* 7 layers with doubling blur values: 1, 2, 4, 8, 16, 32, 64 */
  /* Each layer fades in AND out to blend with neighbors */

  .layer-1 {
    backdrop-filter: blur(1px);
    -webkit-backdrop-filter: blur(1px);
    mask-image: linear-gradient(to top, transparent 65%, black 80%, black 100%);
    -webkit-mask-image: linear-gradient(to top, transparent 65%, black 80%, black 100%);
  }

  .layer-2 {
    backdrop-filter: blur(2px);
    -webkit-backdrop-filter: blur(2px);
    mask-image: linear-gradient(to top, transparent 50%, black 65%, black 85%, transparent 100%);
    -webkit-mask-image: linear-gradient(to top, transparent 50%, black 65%, black 85%, transparent 100%);
  }

  .layer-3 {
    backdrop-filter: blur(4px);
    -webkit-backdrop-filter: blur(4px);
    mask-image: linear-gradient(to top, transparent 35%, black 50%, black 70%, transparent 90%);
    -webkit-mask-image: linear-gradient(to top, transparent 35%, black 50%, black 70%, transparent 90%);
  }

  .layer-4 {
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
    mask-image: linear-gradient(to top, transparent 20%, black 35%, black 55%, transparent 75%);
    -webkit-mask-image: linear-gradient(to top, transparent 20%, black 35%, black 55%, transparent 75%);
  }

  .layer-5 {
    backdrop-filter: blur(16px);
    -webkit-backdrop-filter: blur(16px);
    mask-image: linear-gradient(to top, transparent 5%, black 20%, black 40%, transparent 60%);
    -webkit-mask-image: linear-gradient(to top, transparent 5%, black 20%, black 40%, transparent 60%);
  }

  .layer-6 {
    backdrop-filter: blur(32px);
    -webkit-backdrop-filter: blur(32px);
    mask-image: linear-gradient(to top, transparent 0%, black 5%, black 25%, transparent 45%);
    -webkit-mask-image: linear-gradient(to top, transparent 0%, black 5%, black 25%, transparent 45%);
  }

  .layer-7 {
    backdrop-filter: blur(64px);
    -webkit-backdrop-filter: blur(64px);
    mask-image: linear-gradient(to top, black 0%, black 10%, transparent 30%);
    -webkit-mask-image: linear-gradient(to top, black 0%, black 10%, transparent 30%);
  }

  /* Debug colors mode */
  body.debug-colors .layer-1 { background: rgba(0, 150, 255, 0.5); }
  body.debug-colors .layer-2 { background: rgba(0, 200, 255, 0.5); }
  body.debug-colors .layer-3 { background: rgba(0, 255, 200, 0.5); }
  body.debug-colors .layer-4 { background: rgba(100, 255, 100, 0.5); }
  body.debug-colors .layer-5 { background: rgba(200, 255, 0, 0.5); }
  body.debug-colors .layer-6 { background: rgba(255, 150, 0, 0.5); }
  body.debug-colors .layer-7 { background: rgba(255, 50, 50, 0.5); }

  /* Blur disabled mode - hide entire blur container */
  body.blur-disabled .progressive-blur,
  body.blur-disabled .simple-blur-layer {
    display: none !important;
  }

  /* Scrim layer */
  .scrim-layer {
    position: absolute;
    inset: 0;
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.2s;
    mix-blend-mode: darken;
  }

  /* Noise texture overlay to reduce banding */
  .scrim-layer::after {
    content: '';
    position: absolute;
    inset: 0;
    /* 64x64 tileable noise PNG, base64 encoded */
    background-image: url("data:image/png;base64,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");
    background-repeat: repeat;
    opacity: 0.15;
    mix-blend-mode: multiply;
    pointer-events: none;
  }

  body.scrim-enabled .scrim-layer {
    opacity: 1;
  }

  /* Text level visibility */
  :global(body.text-title-only) .text-overlay > p {
    display: none;
  }

  :global(body.text-with-subtitle) .text-overlay .description {
    display: none;
  }

  .text-overlay {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    padding: 20px;
    color: white;
  }

  .text-overlay.small {
    padding: 12px;
  }

  .text-overlay h3 {
    margin: 0 0 4px 0;
    font-size: 24px;
    font-weight: 600;
    text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
  }

  .text-overlay.small h3 {
    font-size: 18px;
  }

  .text-overlay p {
    margin: 0;
    font-size: 14px;
    color: rgba(255, 255, 255, 0.85);
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
  }

  .text-overlay.small p {
    font-size: 12px;
  }

  .text-overlay .description {
    margin-top: 8px;
    font-size: 13px;
    line-height: 1.4;
    color: rgba(255, 255, 255, 0.75);
  }

  /* Layer visualization */
  .layer-visualization {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .layer-visualization h3 {
    margin: 0;
    font-size: 14px;
    color: var(--text-secondary);
  }

  .mask-preview {
    width: 120px;
    height: 450px;
    background: var(--bg-movie);
    border-radius: 6px;
    overflow: hidden;
    position: relative;
  }

  .mask-bar {
    position: absolute;
    left: 0;
    right: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: opacity 0.2s;
  }

  .mask-bar span {
    font-size: 11px;
    font-family: monospace;
    color: white;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
  }

  /* Position each bar to show its zone - 7 layers spanning 450px */
  /* Layer 7 at bottom (heaviest blur), Layer 1 at top (lightest) */
  .mask-bar.layer-7 { bottom: 0; height: 64px; background: hsl(80, 70%, 25%); }
  .mask-bar.layer-6 { bottom: 64px; height: 64px; background: hsl(100, 70%, 28%); }
  .mask-bar.layer-5 { bottom: 128px; height: 64px; background: hsl(120, 70%, 30%); }
  .mask-bar.layer-4 { bottom: 192px; height: 64px; background: hsl(140, 70%, 35%); }
  .mask-bar.layer-3 { bottom: 256px; height: 64px; background: hsl(160, 70%, 40%); }
  .mask-bar.layer-2 { bottom: 320px; height: 64px; background: hsl(180, 70%, 45%); }
  .mask-bar.layer-1 { bottom: 384px; height: 66px; background: hsl(200, 70%, 50%); }

  .mask-labels {
    display: flex;
    justify-content: space-between;
    font-size: 11px;
    color: var(--text-tertiary);
    font-family: monospace;
  }

  /* Aspect ratio section */
  .aspect-ratio-section {
    max-width: 1200px;
    margin: 48px auto;
    padding: 0 16px;
  }

  .aspect-ratio-section h2 {
    margin: 0 0 8px 0;
    font-size: 18px;
    color: var(--text-primary);
  }

  .section-desc {
    margin: 0 0 24px 0;
    font-size: 14px;
    color: var(--text-secondary);
  }

  .aspect-ratio-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 24px;
    align-items: start;
  }

  /* Aspect ratio variants */
  .poster-card.aspect-2-1 {
    width: 100%;
    height: auto;
    aspect-ratio: 2 / 1;
  }

  .poster-card.aspect-16-9 {
    width: 100%;
    height: auto;
    aspect-ratio: 16 / 9;
  }

  .poster-card.aspect-4-3 {
    width: 100%;
    height: auto;
    aspect-ratio: 4 / 3;
  }

  .poster-card.aspect-1-1 {
    width: 100%;
    height: auto;
    aspect-ratio: 1 / 1;
  }

  .poster-card.aspect-3-4 {
    width: 100%;
    height: auto;
    aspect-ratio: 3 / 4;
  }

  .poster-card.aspect-2-3 {
    width: 100%;
    height: auto;
    aspect-ratio: 2 / 3;
  }

  .poster-card.aspect-9-16 {
    width: 100%;
    height: auto;
    aspect-ratio: 9 / 16;
  }

  .poster-card.aspect-1-2 {
    width: 100%;
    height: auto;
    aspect-ratio: 1 / 2;
  }

  .aspect-ratio-grid .text-overlay {
    padding: 12px;
  }

  .aspect-ratio-grid .text-overlay h3 {
    font-size: 16px;
  }

  .aspect-ratio-grid .text-overlay p {
    font-size: 11px;
  }

  /* Comparison section */
  .comparison-section {
    max-width: 1200px;
    margin: 64px auto 48px;
    padding: 0 16px;
  }

  .comparison-section h2 {
    margin: 0 0 8px 0;
    font-size: 24px;
    color: var(--text-primary);
  }

  .comparison-container {
    display: flex;
    flex-wrap: wrap;
    gap: 24px;
    margin-top: 24px;
    justify-content: center;
    align-items: flex-end;
  }

  .sbs-card {
    position: relative;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
    cursor: ew-resize;
  }

  .sbs-card[data-aspect="2-1"] { width: 400px; height: 200px; }
  .sbs-card[data-aspect="16-9"] { width: 356px; height: 200px; }
  .sbs-card[data-aspect="3-4"] { width: 180px; height: 240px; }
  .sbs-card[data-aspect="2-3"] { width: 160px; height: 240px; }

  .sbs-card > .poster-image {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    z-index: 0;
  }

  .comparison-side {
    position: absolute;
    inset: 0;
    overflow: hidden;
  }

  .comparison-left { clip-path: inset(0 50% 0 0); z-index: 1; }
  .comparison-right { clip-path: inset(0 0 0 50%); z-index: 1; }

  .comparison-image {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .comparison-side .simple-blur-layer,
  .comparison-side .progressive-blur { position: absolute; inset: 0; z-index: 1; }
  .comparison-side .scrim-layer { position: absolute; inset: 0; z-index: 2; pointer-events: none; opacity: 0; mix-blend-mode: darken; }
  :global(body.scrim-enabled) .comparison-side .scrim-layer { opacity: 1; }

  .comparison-side .text-overlay {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    padding: 0.5rem 1rem 1rem;
    color: white;
    z-index: 10;
  }

  .comparison-side .text-overlay h3 { margin: 0 0 4px; font-size: 18px; font-weight: 600; text-shadow: 0 1px 3px rgba(0,0,0,0.5); }
  .comparison-side .text-overlay p { margin: 0; font-size: 12px; color: rgba(255,255,255,0.85); text-shadow: 0 1px 2px rgba(0,0,0,0.5); }
  .comparison-side .text-overlay .description { margin-top: 4px; font-size: 11px; line-height: 1.3; color: rgba(255,255,255,0.75); }

  .side-label {
    position: absolute;
    top: 8px;
    padding: 3px 8px;
    background: rgba(0,0,0,0.6);
    color: white;
    font-size: 10px;
    font-weight: 500;
    border-radius: 3px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    z-index: 15;
  }

  .comparison-left .side-label { left: 8px; }
  .comparison-right .side-label { right: 8px; }

  .comparison-slider {
    position: absolute;
    top: 0;
    bottom: 0;
    left: 50%;
    width: 3px;
    background: white;
    transform: translateX(-50%);
    z-index: 20;
    cursor: ew-resize;
    box-shadow: 0 0 8px rgba(0,0,0,0.5);
  }

  .slider-handle {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 32px;
    height: 32px;
    background: white;
    border-radius: 50%;
    box-shadow: 0 2px 8px rgba(0,0,0,0.3);
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .slider-handle::before { content: '⟷'; font-size: 14px; color: #333; }

  /* Simple blur for comparison */
  .simple-blur-layer {
    position: absolute;
    inset: 0;
    backdrop-filter: blur(16px);
    -webkit-backdrop-filter: blur(16px);
    mask-image: linear-gradient(to top, black 15%, transparent 50%);
    -webkit-mask-image: linear-gradient(to top, black 15%, transparent 50%);
    pointer-events: none;
  }

  /* Info section */
  .info-section {
    max-width: 600px;
    margin: 32px auto;
    padding: 24px;
    background: var(--bg-movie);
    border-radius: 8px;
  }

  .info-section h2 {
    margin: 0 0 12px 0;
    font-size: 18px;
    color: var(--text-primary);
  }

  .info-section p {
    margin: 0 0 12px 0;
    font-size: 14px;
    color: var(--text-secondary);
    line-height: 1.5;
  }

  .info-section pre {
    background: var(--bg-movie-hover);
    padding: 12px 16px;
    border-radius: 6px;
    overflow-x: auto;
    margin: 12px 0;
  }

  .info-section pre code {
    font-size: 11px;
    line-height: 1.5;
    color: var(--text-primary);
  }

  .note {
    background: rgba(100, 150, 255, 0.1);
    border-left: 3px solid rgba(100, 150, 255, 0.5);
    padding: 12px;
    border-radius: 0 6px 6px 0;
    margin-top: 16px;
  }
</style>
